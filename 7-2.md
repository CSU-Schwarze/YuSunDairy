### 7.2
#### 弱口令、验证码、爆破
```
先对资产进行漏洞扫描，使用Wappalyzer对网站使用的技术栈进行剖析，查找技术栈中的技术是否存在可以利用的如1day、nday等漏洞，随后优先针对后台进行测试

网站前端代码三件套：HTML+CSS+JS，vue.js。通过浏览器查看源码可以看到源码，也可以修改前段代码造成XSS漏洞，XSS漏洞是用户可以在前端写入JavaScript语句，使得JS语句在前端可以运行

后端开发脚本：PHP、ASP、ASP.NET、JavaWeb（大部分使用、稳定、高并发），可以通过文件上传，上传恶意代码在服务器端执行，要根据网站的搭建语言来针对性构建对应语言的恶意代码脚本上传，不然无法运行；Web中间件/服务器（解析后端开发脚本并执行）：Nginx（PHP）、IIS（ASP+ASP.NET）、Tomcat（JavaWeb）、Apache（Kali自带），中间件也存在很多漏洞，可以加以利用；以Nginx为例，Nginx存在解析和截断漏洞

服务器端经常会有数据库操作，所以也可以构造一些数据库查询的语句，如SQL语句，这些语句可以在服务器端的数据库执行，造成SQL注入漏洞
```
#### 弱口令
```
用户名枚举漏洞是利用对于用户名是否存在的回显信息可以测试得出用户的用户名，如果无法得出，可以利用常见的用户名进行爆破，可以使用BP的Inturder模块，由于只需要爆破单个目标，可以使用Sniper爆破，当爆破速率过高且目标具有WAF防火墙时，可能会被BAN掉，因此需要合理设置爆破速率，模拟真实访问的请求；如果无法区分是否爆破成功，在爆破设置中可以对返回页面的指定内容进行标记，根据爆破返回的标记情况区分爆破是否成功

以www.dslawyer.com为例，先利用用户名枚举得到admin用户名，在登录时抓包并拦截，发送到Intruder，不能释放数据包，利用验证码复用漏洞使多次爆破使用同一验证码，利用字典对admin用户的密码进行爆破，根据返回数据包的长度、返回状态码（3XX重定向），可以发现密码为123654，可以成功进行登录。真实攻击还是要使用更深层次的漏洞，如SQL注入、文件上传等漏洞

常见系统的弱口令：XXLJOB任务调度系统（默认账号admin，默认密码123456）、K8s控制台（默认账号admin，默认密码P@88w0rd）、ZABBIX系统监控（默认账号admin、默认密码zabbix）、activeMQ组件（默认账号admin/、默认密码admin）、NACOS系统监控（默认账号NACOS、默认密码NACOS）、Grafana控制台（默认账号admin、默认密码admin）、Druid组件（默认账号admin、默认密码123456）、若依（默认账号admin、默认密码admin123）。通过XXLJOB可以在shell、powershell等执行指定参数命令，常见的是NACOS和XXLJOB

除了传统字典，还有社工字典工具TscanPlus，有社工模式、组合模式、枚举模式，可以生成多种密码
```
### 业务逻辑漏洞
```
包括支付漏洞、越权漏洞、密码找回、信息泄露、积分兑换和抽奖

密码找回漏洞可以用于进行用户名枚举，一般校验流程是首先输入自己的手机号，随后服务器会对手机号进行验证，检查是否存在用户，填写验证码证明是本人操作，随后填写新密码进行重置。漏洞主要存在于填写验证码和新的密码这一部分，讲了兰州市城关区智慧教育云平台的例子，其没有对发送验证码的手机号码做验证，导致可以绕过验证码，进而修改密码;
使用PortSwigger的密码重置破坏逻辑实验的例子，进行了密码找回漏洞的实验


支付漏洞可以把金额改为负数，实现0元购。使用墨者靶场进行了支付漏洞的实验

越权访问漏洞包括水平越权和垂直越权，水平越权是同级用户之间可以越权进行操作，而垂直越权是不同级别或不同角色之间的角色之间的越权操作，如普通用户可以执行管理员才能执行的功能。越权访问漏洞主要发生在Cookie验证不严，简单判断用户提交的参数的情况，本质上是这些参数在客户端提交，但没有在服务器严格进行校验。举了飞飞影视导航系统的例子，登录用户后可以修改url实现水平越权。还举了湖南省全员核酸检测小程序的例子，通过遍历用户ID，可以获取千万级的用户信息

测试水平越权可以注册普通账号进行测试，垂直越权的测试思路是如何获取管理员用户权限，根据泄露的大量接口使用普通用户去测试哪些接口是管理用户特权
```
